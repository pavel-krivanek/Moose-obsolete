todo: Refactor to two strategies:
- profiling
- debugging